# react-deploy-practice
github action을 활용한 react 프로젝트 S3, cloudfront, dns




## 필요이유
이전 프로젝트에서의 환경
 : 프론트엔드(CSR) + 백엔드 환경에서 백엔드 서버(EC2)의 리버스 프록시(NginX)에 빌드된 프론트엔드 정적 파일들을 둔 형태

#### 이전 환경에서의 발생할 수 있는 문제점
1. 과도한 API 트래픽으로 백엔드 서버(EC2)가 불안정해질 경우 프론트 어플리케이션을 서빙할때 문제가 발생할 수 있음
   -> 클라이언트에서 화면 요청이 올 경우 Error Page가 뜨며 어플리케이션 전체가 멈춘듯한 경험을 줄 수도 있음
2. 반대로 페이지 요청 수가 과도하게 많아질 경우에도 정적 서빙뿐 아니라 API 성능까지 영향을 미칠 수 있음
   -> 즉, API서버와 화면 서빙이 서로 독립적이지 않고 연관성을 가져 서로의 성능에 영향을 끼칠 수 있음
3. CI/CD를 적용한 빌드 프로세스에서도 프론트엔드 환경과 백엔드 환경이 동일하여 서로의 환경에 영향을 끼칠 수 있음
   -> 백엔드 빌드가 완료될때 까지 프론트엔드가 기다려야 하는 등의 생산성 문제가 발생할 수 있음


## 해결방안
S3와 cloudfront를 활용하여 백엔드 서버에서 프론트 환경을 따로 분리시켜 적용해보자

## S3란?
AWS에서 제공하는 클라우드 스토리지 서비스, 즉 저장소의 역할을 하는 서비스이며 파일, 이미지, 데이터와 같은 다양한 유형의 파일들을 저장하고 요청에 따라 서빙하거나 관리할 수 있다.

#### 해결방법으로 S3를 택한 이유
1. CSR로 기획된 프로젝트의 경우 빌드시 정적 파일을 클라이언트 단 브라우저가 읽어서 이를 랜더링 하는 형태로 SSR과 달리 JS 파일을 읽고 랜더링 하는 서버가 필요 없다.
2. 즉 빌드된 결과물만 저장하고 이를 클라이언트의 브라우저에 서빙하는 저장소의 역할로 S3를 택할 수 있다.

## CloudFront란?
AWS에서 제공하는 CDN(Content Delivery Network)으로 빠른 속도로 파일들을 제공하고 추가적인 보안 기능을 제공하는 네트워크 서비스
여러 물리적인 지역(서울, 미국 등)에 엣지 로케이션을 두어 제공하려는 파일들을 캐싱하여 사용자가 물리적으로 가까운 지역에 연결되도록 하여 지연 속도를 줄인다.

#### 해결방방법으로 CloudFront를 택한 이유
1. AWS에서 제공하는 서비스와의 통합이 매우 간편하다.
2. S3에 저장된 빌드 결과물을 캐싱하여 매우 빠르게 유저들에게 제공할 수 있다.
3. SSL을 발급받아 HTTPS를 설정하는것이 간편하다.
4. AWS의 계정 소유자가 아닌 다른 사용자들이 S3에 직접 접근하는 것을 막고 CloudFront를 통해서만 접근 가능하게 하여 보안적으로 유리하다.


## 목표
이에 S3 + CloudFront로 프론트엔드 환경을 분리하고 github action을 통해 레포지토리에 S3, cloudfront를 연결하여 CI/CD를 구축하는 것

## 진행할 단계
1. S3 저장소 만들기
2. CloudFront를 통해서 S3를 접근 가능하게 만들고 정적 파일을 캐싱하여 서빙하기
3. 도메인을 등록하여 CloudFront와 통합, Amazon Certificate Manager를 통해 인증서 발급받아 https 적용
4. Github action을 통해 여러 설정 알아보고 레포지토리 변경시 S3에 파일을 업로드하고 CloudFront에 캐싱되어있던 정적파일들 무효화 이후, 다시 캐싱되게 하기
 
